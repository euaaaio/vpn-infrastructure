---
- name: Create or update Cloudflare DNS records
  community.general.cloudflare_dns:
    zone: "{{ cloudflare_zone }}"
    record: "{{ item }}"
    type: A
    value: "{{ ansible_default_ipv4.address }}"
    proxied: false
    api_token: "{{ cloudflare_api_token }}"
    state: present
  loop:
    - "{{ domain }}"
    - "{{ subscription_domain }}"

- name: Display DNS configuration
  ansible.builtin.debug:
    msg: |
      DNS records configured:
        - {{ domain }} -> {{ ansible_default_ipv4.address }}
        - {{ subscription_domain }} -> {{ ansible_default_ipv4.address }}
